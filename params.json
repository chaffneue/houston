{"name":"Houston - The Multi-Master Midi Clock","tagline":"A live performance oriented midi playback controller for 4 independent channels. Sync your gear to the beat every time!","body":"## Houston Multi Master Midi Clock\r\n\r\n![Meet Houston](https://c2.staticflickr.com/2/1579/24839778126_2c2a3d20b4_z.jpg)\r\n\r\nIntroducing Houston: A bomb-proof, OSHW multi-master MIDI clock that you can build for about $50 using readily available parts. Make it the center of your live pa rig!\r\n\r\n\r\n## The Problem\r\n\r\nNormally, MIDI devices are slaved to a single master unit, but what if something about that unit crashes or blocks playback for whatever reason? Short answer: \"kablammo!\" Additionally, if a slave device fails to playback, there's not much recourse for resyncing it to the rest of the performance. In live performance applications, this means that one wrong move on the sequencers means a major interruption of the music.\r\n\r\nThis device provides a solid performance playback platform that:\r\n\r\n* Drastically lowers the chances of a full audio lockup (DAW crashes, PC hardware communication issues, playback-blocking sequencer parameter changes, etc.)\r\n* Automatically stops, rewinds and resyncs up to 4 channels of MIDI slaves back into the mix on the downbeat with a selectable count-in. It dramatically frees up your hands to focus on the mix and switch to new songs unit by unit without interruption.  \r\n\r\n\r\n## Features\r\n\r\n* 4 independent, hardware UART synchronized midi channels (+/- 0.1 BPM jitter) \r\n* Large, intuitive displays to show all performance parameters including the count-in time, the current tempo and the current measure\r\n* Huge, 12mm OMRON buttons to prevent fat-fingering the controls\r\n* A clear, multicolored beat lamp to help visualize the beat\r\n* Microcontroller based with very limited responsibilities which greatly reduces the risk of a crash during a performance\r\n* Usb powered and programmed\r\n* Open Source Hardware - contribute to making it better or fork it and add your own requirements\r\n* Based on commodity parts freely available on eBay and the ubiqitous Arduino Mega2560 R3 board and development environment \r\n\r\n\r\n## Build Notes\r\n\r\nThe hardware comprises of 6 modules. I have built these modules using separate perf boards in the prototype. \r\n\r\n* The LCD Display (shows tempo and count-in parameters)\r\n* The 8x8 Matrix display (used to show track position)\r\n* The beat lamp display \r\n* The Control surface board\r\n* The Arduino board\r\n* The MIDI IO board\r\n\r\n### The LCD Display\r\n\r\nBased on a 1602 (16 char x 2 line) LCD, you really only need to add an adapter board for LCD contrast, since the Arduino bit bangs each pin directly. See the photos below for how I mounted the little breakout board. \r\n\r\n### The 8x8 matrix display board\r\n\r\nThe 8x8 matrix is the trickiest part to build, but it's very hard to mess up. If you've never used this hardware before, you can breadboard it first to ensureall the parts work before soldering them. I used a double sided perf board with vias to build the prototype. This allows me to install the TLC5940 chips on the bottom of the board and the transistors and jumpers on the top side which is neatly sandwiched between the LED matrix when assembled. Note that the 100K pull up resistors on the transistor bases are optional (they reduce switching noise at slower refresh speeds). I didn't use them in the final build due to space constraints.  \r\n \r\n### The beat lamp\r\n\r\nI used an off the shelf multicolor led mounded to a small pcb and added a 1k current limiting resistor attached to ground. My board had mislabelled the color channeld, so do check the colors are as you expect (you can always fix it in firmware later as long as ground is correct). The model used was KY-016: <https://tkkrlab.nl/wiki/Arduino_KY-016_3-color_LED_module>.  \r\n\r\n### The control surface\r\n\r\nI build the control surface board using a 7cm x 9cm single sided perf board. The only lesson I have with this is to find a board that isn't quite as cheaply drilled as mine was. Some of the button holes needed a lot of filing to line up bacause the pads and mounting holes were not to the same spec. The switches do have quite chunky leads, so really use a lot of solder on at least two contact pins to make sure nothing comes loose. Dry fit the heck out of the button panel before you drill :) \r\n\r\n### The Arduino board\r\n\r\nThis is a specialized clone that nice and small while retaining a good quality USB programmer. It is readily available on ebay and epalsite for around $10-$15 here <http://www.epalsite.com/store/meduino-mega2560-r3-pro-mini-board-small-size.html>\r\nIt's compatible with the 2560 R3 and coes with a bootloader already installed. See the firmware instructions below to build and flash this sucker. \r\n\r\n### The MIDI IO board\r\n\r\nI cut down a perfboard to the width measurements shown in the case <https://github.com/chaffneue/houston/blob/master/illustrator/houston-back-panel.pdf> the board's length isn't too important, but do use a good quality pcb as the flimsy PC mount Din jacks can be hard on pads. Additionally, once mounted, use a zap strap or a few screws behind the midi jack to relieve the strain of inserting the din plugs. \r\n\r\n### Prototype Build Photos\r\n\r\nHigher resolution photo album here:\r\n\r\n<https://www.flickr.com/photos/chaffneue/albums/72157663690274979>\r\n\r\n\r\nThe controls, midi, beat lamp and assembled matrix board. I ended up putting the control panel pin header on the bottom of the board.\r\n![Prototype boards](https://c2.staticflickr.com/2/1554/24772597651_0b3c4b72b7_c.jpg)\r\n\r\n\r\nThe Embeddable Meduino 2560 R3 board\r\n![The brains](https://c2.staticflickr.com/2/1592/24839725796_4130377276_c.jpg)\r\n\r\n\r\nThe Matrix board IC, header and transistor placement\r\n![Bottom Side](https://c2.staticflickr.com/2/1680/24239139963_fec8a018e4.jpg)\r\n![Top Side](https://c2.staticflickr.com/2/1667/24839724806_0ac5885f90.jpg)\r\n\r\n\r\nCase details - The prototype is made with a steel 3.5\" external HD enclosure which can be had for $10-$20. Punch the holes nice and deep and drill them out carefully. I used a 2,3,5 and 12mm drill bit and a small hobby file set to clean up the burrs. I used a nibbler tool for the LCD and midi jack case openings. The better clamped down the case is while drilling, the better the finish. I used some painters tape to avoid scratching the paint as much as possible.\r\n\r\n![Punching the holes](https://c2.staticflickr.com/2/1559/24772569491_ccf54a892d_c.jpg)\r\n![Drilling a million holes](https://c2.staticflickr.com/2/1443/24748092312_9d1bb364e4_c.jpg)\r\n\r\nCabling - note the orientation of the switch plate and it's header. You can also see the adapter board for the LCD screen on its pin header. \r\n![Routing the cables](https://c2.staticflickr.com/2/1551/24498397969_68e669834e_c.jpg)\r\n\r\n\r\nThe back panel interface openings\r\n![Back panel](https://c2.staticflickr.com/2/1456/24237887604_a43d87637e_c.jpg)\r\n\r\n\r\n## Building the Firmware\r\n\r\nYou'll need \r\n* The Github Desktop app <https://desktop.github.com/>\r\n* The Arduino IDE <https://www.arduino.cc/en/Main/Software>\r\n\r\nThe project is buildable from source using the Arduino IDE's built in make file. All you need to do is fork to your own private copy then git clone using Github Desktop (your forks will show up automagically in Github Desktop :)). The nice thing about forking is that you can (and should) change the project with impunity. Want i2c parts? go for it! Different matrix drivers? CV sync? hell yes! do it! The firmware code is documented and separated into discrete tasks, so it should be easy to extend to your live rig's needs.    \r\n\r\nThe {arduino_ide_project_path} is usually in your \"My Documents/Arduino\" folder on windows and \"/path/to/user/Documents/Arduino\" on the mac \r\n\r\nFork and clone the firmware sketches into {arduino_ide_project_path}\r\nhttps://github.com/chaffneue/houston\r\n\r\n\r\nFork and clone the following libraries in {arduino_ide_project_path}/libraries:\r\nhttps://github.com/chaffneue/DirectIO\r\nhttps://github.com/chaffneue/TaskScheduler\r\nhttps://github.com/chaffneue/LiquidCrystal\r\nhttps://github.com/chaffneue/TLC5940\r\nhttps://github.com/chaffneue/arduino_midi_library\r\n\r\nIn the Arduino IDE, load the houston sketch from {arduino_ide_project_path}/houston/houston.ino\r\n\r\nPlug your Houston box into USB and choose:\r\n* Board Type: Arduino/Genuino Mega or Mega 2560\r\n* Processor: ATmega2560 (Mega 2560)\r\n* Port: Whatever port was found after plugging in the arduino board\r\n* Programmer: AVRISP mkII\r\n\r\nThen click the upload (->) button to build and upload the firmware. It's a good idea to do this as a first step and dry test the components on a breadboard.\r\n\r\nAnd damnit. Have fun!","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}